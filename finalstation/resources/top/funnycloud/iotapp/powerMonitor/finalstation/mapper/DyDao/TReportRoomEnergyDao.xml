<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.funnycloud.iotapp.powerMonitor.finalstation.dao.IDao.DyDao.TReportRoomEnergyDao">
  <resultMap id="BaseResultMap" type="top.funnycloud.iotdata.comm.report.model.roomdata.TReportRoomEnergyModel">
    <id column="f_RecordID" jdbcType="INTEGER" property="p_recordid" />
    <result column="f_CompanyCD" jdbcType="VARCHAR" property="p_companycd" />
    <result column="f_ProjectCD" jdbcType="VARCHAR" property="p_projectcd" />
    <result column="f_RoomCD" jdbcType="VARCHAR" property="p_roomcd" />
    <result column="f_Remarks" jdbcType="VARCHAR" property="p_remarks" />
    <result column="f_UpdateTimes" jdbcType="TIMESTAMP" property="p_updatetimes" />
    <result column="f_CreateTimes" jdbcType="CHAR" property="p_createtimes" />
    <result column="f_SaftyDayCount" jdbcType="INTEGER" property="p_saftydaycount" />
    <result column="f_DayAlarmCount" jdbcType="INTEGER" property="p_dayalarmcount" />
    <result column="f_MonthAlarmCount" jdbcType="INTEGER" property="p_monthalarmcount" />
    <result column="f_YearAlarmCount" jdbcType="INTEGER" property="p_yearalarmcount" />
    <result column="f_JsonData" jdbcType="VARCHAR" property="p_jsondata" />
  </resultMap>
  <sql id="Base_Column_List">
    f_RecordID, f_CompanyCD, f_ProjectCD, f_RoomCD, f_Remarks, f_UpdateTimes, f_CreateTimes,
    f_SaftyDayCount, f_DayAlarmCount, f_MonthAlarmCount, f_YearAlarmCount, f_JsonData
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from  ${tableName}
    where f_RecordID = #{recordid,jdbcType=INTEGER}
  </select>


  <select id="selectByCreatTime"  resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from  ${tableName}
    where  f_CompanyCD = #{companycd,jdbcType=VARCHAR}   and f_ProjectCD = #{projectcd,jdbcType=VARCHAR}    and f_RoomCD = #{roomcd,jdbcType=VARCHAR}   and f_CreateTimes = #{creatTime,jdbcType=CHAR}
  </select>

  <select id="selectByParam"  resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from  ${tableName}
    where 1=1
    <if test="companycd!=null and companycd!=''">
      and  f_CompanyCD = #{companycd,jdbcType=VARCHAR}
    </if>
    <if test="projectcd!=null and projectcd!=''">
      and f_ProjectCD = #{projectcd,jdbcType=VARCHAR}
    </if>
    <if test="roomcd!=null and roomcd!=''">
      and f_RoomCD = #{roomcd,jdbcType=VARCHAR}
    </if>
    <if test="startTime!=null and startTime!=''">
      and f_CreateTimes  <![CDATA[   >=  ]]>  #{startTime,jdbcType=CHAR}
    </if>
    <if test="endTime!=null and  endTime!=''">
      and f_CreateTimes  <![CDATA[  <  ]]>  #{endTime,jdbcType=CHAR}
    </if>
  </select>
  <select id="selectByParamTimes"  resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from  ${tableName}
    where 1=1
    <if test="companycd!=null and companycd!=''">
      and  f_CompanyCD = #{companycd,jdbcType=VARCHAR}
    </if>
    <if test="projectcd!=null and projectcd!=''">
      and f_ProjectCD = #{projectcd,jdbcType=VARCHAR}
    </if>
    <if test="roomcd!=null and roomcd!=''">
      and f_RoomCD = #{roomcd,jdbcType=VARCHAR}
    </if>
    and f_CreateTimes  in
      <foreach item="item"
               index="index"
               collection="times"
               open="("
               separator=","
               close=")">
        #{item}
      </foreach>
  </select>
  <insert id="upInsert"  useGeneratedKeys="true" keyProperty="item.p_recordid">
    insert into ${tableName} ( f_CompanyCD, f_ProjectCD,
      f_RoomCD, f_Remarks,
      f_CreateTimes, f_SaftyDayCount, f_DayAlarmCount,
      f_MonthAlarmCount, f_YearAlarmCount, f_JsonData
      )
    values (#{item.p_companycd,jdbcType=VARCHAR}, #{item.p_projectcd,jdbcType=VARCHAR},
      #{item.p_roomcd,jdbcType=VARCHAR}, #{item.p_remarks,jdbcType=VARCHAR},
      #{item.p_createtimes,jdbcType=CHAR}, #{item.p_saftydaycount,jdbcType=INTEGER}, #{item.p_dayalarmcount,jdbcType=INTEGER},
      #{item.p_monthalarmcount,jdbcType=INTEGER}, #{item.p_yearalarmcount,jdbcType=INTEGER}, #{item.p_jsondata,jdbcType=VARCHAR}
      )
    ON DUPLICATE KEY UPDATE
    f_SaftyDayCount = VALUES(f_SaftyDayCount),
    f_DayAlarmCount = VALUES(f_DayAlarmCount),
    f_MonthAlarmCount = VALUES(f_MonthAlarmCount),
    f_YearAlarmCount = VALUES(f_YearAlarmCount),
    f_JsonData = VALUES(f_JsonData)
  </insert>

</mapper>